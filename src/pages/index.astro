---
import BaseHead from '../components/BaseHead.astro';
import HeaderArchitectural from '../components/HeaderArchitectural.astro';
import HeroArchitectural from '../components/HeroArchitectural.astro';
import ProjectGridArchitectural from '../components/ProjectGridArchitectural.astro';
import GlassCard from '../components/GlassCard.astro';
import BackToTop from '../components/BackToTop.astro';
import ScrollProgress from '../components/ScrollProgress.astro';
import PageLoader from '../components/PageLoader.astro';
import PageTransition from '../components/PageTransition.astro';
import SkipLink from '../components/SkipLink.astro';
import Footer from '../components/Footer.astro';
import { getCollection } from 'astro:content';
import { SITE_TITLE, SITE_DESCRIPTION } from '../consts';
import FormattedDate from '../components/FormattedDate.astro';

// Get featured posts
const allPosts = await getCollection('blog');
const featuredPosts = allPosts.slice(0, 3);

// Featured projects
const featuredProjects = [
	{
		title: '对马岛之魂草地渲染复刻',
		category: 'Real-time Rendering',
		year: '2025',
		description: '使用UE复刻《对马岛之魂》开场震撼草地场景，包含Niagara风场系统、WPO弯曲系统和完整的程序化植被实现。',
		tags: ['Unreal Engine', 'Niagara', 'WPO', '植被渲染'],
		link: 'https://www.bilibili.com/video/BV1VLz1B7ERq/',
		image: '/images/grass/Camera.0237.png'
	},
	{
		title: 'B站个人作品集',
		category: 'Portfolio',
		year: '2025',
		description: '个人作品视频展示，包含多个实时渲染和技术美术项目演示视频。',
		tags: ['Portfolio', 'Bilibili', '视频展示'],
		link: 'https://www.bilibili.com/video/BV18Yq5BmE3f/',
		image: '/images/bilibili-video-cover.png'
	}
];

// Skills and services
const services = [
	{
		number: '01',
		title: 'Shader Development',
		description: 'HLSL/GLSL着色器开发，从基础材质到高级视觉效果'
	},
	{
		number: '02',
		title: 'Rendering Optimization',
		description: '渲染管线性能优化，Draw Call批处理，GPU Instancing'
	}
];
---

<!doctype html>
<html lang="en">
	<head>
		<BaseHead title={SITE_TITLE} description={SITE_DESCRIPTION} />
	</head>

	<body>
		<PageLoader />
		<PageTransition />
		<ScrollProgress />
		<SkipLink />
		<HeaderArchitectural />

		<main id="main-content">
			<HeroArchitectural />

			<!-- Services Section -->
			<section class="services-section">
			<div class="services-grid">
				{services.map((service, index) => (
					<GlassCard
						class="service-card"
						delay={index * 100}
					>
						<div class="service-number">{service.number}</div>
						<h3 class="service-title">{service.title}</h3>
						<p class="service-description">{service.description}</p>
					</GlassCard>
				))}
			</div>
		</section>

		<!-- Projects Section -->
		<ProjectGridArchitectural projects={featuredProjects} />

		<!-- Featured Posts Section -->
		<section class="featured-posts-section">
			<div class="section-header">
				<div class="section-label">
					<span class="label-line"></span>
					<span class="label-text">Insights</span>
				</div>
				<h2 class="section-title">精选文章</h2>
				<p class="section-subtitle">最新技术分享与思考</p>
			</div>
			<div class="posts-grid">
				{featuredPosts.map((post, index) => (
					<a
						href={`/blog/${post.slug}`}
						class="post-card"
						style={`animation-delay: ${index * 100}ms`}
					>
						<div class="post-meta">
							<span class="post-category">{post.data.category}</span>
							<span class="post-date">
								<FormattedDate date={post.data.pubDate} />
							</span>
						</div>
						<h3 class="post-title">{post.data.title}</h3>
						<p class="post-description">{post.data.description}</p>
						<div class="post-tags">
							{post.data.tags?.slice(0, 3).map(tag => (
								<span class="tag">{tag}</span>
							))}
						</div>
					</a>
				))}
			</div>
			<a href="/blog" class="view-all-link">
				<span>查看全部文章</span>
				<span class="link-arrow">→</span>
			</a>
		</section>

		<!-- About Section -->
		<section class="about-section">
			<div class="about-content">
				<div class="about-text">
					<div class="section-label">
						<span class="label-line"></span>
						<span class="label-text">About</span>
					</div>
					<h2 class="about-title">
						技术美术<br />
						<span class="highlight">位于中国</span>
					</h2>
					<p class="about-description">
						专注于实时渲染技术、Shader开发和工具链优化。
						致力于创造令人惊叹的视觉效果，同时保证性能表现。
						相信艺术与技术的完美融合是创造优秀作品的关键。
					</p>
					<a href="/about" class="about-link">
						<span>了解更多</span>
						<span class="link-arrow">→</span>
					</a>
				</div>
				<div class="about-visual">
					<div class="visual-grid">
						<div class="grid-item"></div>
						<div class="grid-item"></div>
						<div class="grid-item"></div>
						<div class="grid-item"></div>
					</div>
				</div>
			</div>
		</section>

			<!-- Contact CTA -->
			<section class="contact-cta">
				<div class="cta-content">
					<h2 class="cta-title">让我们合作</h2>
					<p class="cta-description">
						有项目想法或想要合作？欢迎随时联系我。
					</p>
					<a href="/contact" class="cta-button">
						<span>联系我</span>
					</a>
				</div>
				<div class="cta-decoration">
					<div class="deco-line"></div>
				</div>
			</section>
		</main>

		<!-- Footer -->
		<Footer />

		<BackToTop />

		<style>
			/* Services Section */
			.services-section {
				padding: 8em 4em 10em;
				background: var(--color-bg-primary);
				position: relative;
			}

			.services-grid {
				display: grid;
				grid-template-columns: repeat(2, 1fr);
				gap: 2em;
				max-width: 900px;
				margin: 0 auto;
			}

			.service-card {
				min-height: 280px;
				display: flex;
				flex-direction: column;
				gap: 1.5em;
				padding: 2.5em 2em;
				position: relative;
			}

			.service-card::before {
				content: '';
				position: absolute;
				top: 0;
				left: 0;
				right: 0;
				height: 2px;
				background: linear-gradient(
					90deg,
					transparent 0%,
					var(--border-hover) 50%,
					transparent 100%
				);
				opacity: 0;
				transition: opacity 0.4s ease;
			}

			.service-card:hover::before {
				opacity: 1;
			}

			.service-number {
				font-size: 0.65em;
				font-weight: 300;
				letter-spacing: 0.3em;
				color: rgba(255, 255, 255, 0.25);
				font-family: 'Space Mono', monospace;
				margin-bottom: 0.5em;
			}

			.service-title {
				font-size: 1.3em;
				font-weight: 300;
				letter-spacing: 0.02em;
				color: var(--color-text-primary);
				margin: 0;
				line-height: 1.3;
			}

			.service-description {
				font-size: 0.9em;
				line-height: 1.8;
				color: var(--color-text-tertiary);
				margin: 0;
			}

			/* Featured Posts Section */
			.featured-posts-section {
				padding: 8em 4em;
				background: var(--color-bg-primary);
				position: relative;
			}

			.section-header {
				text-align: center;
				max-width: 600px;
				margin: 0 auto 4em;
			}

			.section-title {
				font-size: clamp(2em, 4vw, 3em);
				font-weight: 300;
				letter-spacing: -0.02em;
				color: var(--color-text-primary);
				margin: 0.5em 0 0.5em 0;
			}

			.section-subtitle {
				font-size: 0.9em;
				color: var(--color-text-tertiary);
				letter-spacing: 0.1em;
				text-transform: uppercase;
				margin: 0;
			}

			.posts-grid {
				display: grid;
				grid-template-columns: repeat(3, 1fr);
				gap: 2em;
				max-width: 1400px;
				margin: 0 auto 3em;
			}

			.post-card {
				background: rgba(255, 255, 255, var(--glass-opacity-bg));
				border: 1px solid rgba(255, 255, 255, 0.06);
				border-radius: 16px;
				padding: 2em;
				display: flex;
				flex-direction: column;
				gap: 1em;
				text-decoration: none;
				color: inherit;
				transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
				position: relative;
				overflow: hidden;
				animation: fadeInUp 0.6s ease-out forwards;
				opacity: 0;
			}

			@keyframes fadeInUp {
				from {
					opacity: 0;
					transform: translateY(20px);
				}
				to {
					opacity: 1;
					transform: translateY(0);
				}
			}

			.post-card::before {
				content: '';
				position: absolute;
				top: 0;
				left: 0;
				right: 0;
				height: 2px;
				background: linear-gradient(
					90deg,
					transparent 0%,
					rgba(99, 102, 241, 0.5) 50%,
					transparent 100%
				);
				opacity: 0;
				transition: opacity 0.4s ease;
			}

			.post-card:hover {
				transform: translateY(-4px);
				background: rgba(255, 255, 255, var(--glass-opacity-bg-hover));
				border-color: rgba(99, 102, 241, 0.2);
				box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
			}

			.post-card:hover::before {
				opacity: 1;
			}

			.post-meta {
				display: flex;
				align-items: center;
				gap: 1em;
				font-size: 0.75em;
			}

			.post-category {
				padding: 0.3em 0.8em;
				background: rgba(99, 102, 241, 0.15);
				border: 1px solid rgba(99, 102, 241, 0.25);
				border-radius: 20px;
				color: rgba(167, 139, 250, 0.9);
				font-weight: 500;
				letter-spacing: 0.05em;
			}

			.post-date {
				color: var(--color-text-muted);
				font-family: 'Space Mono', monospace;
			}

			.post-title {
				font-size: 1.2em;
				font-weight: 500;
				color: var(--color-text-primary);
				margin: 0;
				line-height: 1.4;
				display: -webkit-box;
				-webkit-line-clamp: 2;
				-webkit-box-orient: vertical;
				overflow: hidden;
			}

			.post-description {
				font-size: 0.9em;
				line-height: 1.7;
				color: var(--color-text-tertiary);
				margin: 0;
				display: -webkit-box;
				-webkit-line-clamp: 3;
				-webkit-box-orient: vertical;
				overflow: hidden;
				flex-grow: 1;
			}

			.post-tags {
				display: flex;
				flex-wrap: wrap;
				gap: 0.5em;
				margin-top: auto;
			}

			.post-tags .tag {
				font-size: 0.75em;
				padding: 0.25em 0.6em;
				background: rgba(255, 255, 255, 0.04);
				border: 1px solid rgba(255, 255, 255, 0.08);
				border-radius: 4px;
				color: var(--color-text-muted);
				transition: all 0.3s ease;
			}

			.post-card:hover .tag {
				background: rgba(99, 102, 241, 0.1);
				border-color: rgba(99, 102, 241, 0.2);
				color: rgba(167, 139, 250, 0.8);
			}

			.view-all-link {
				display: inline-flex;
				align-items: center;
				justify-content: center;
				gap: 0.75em;
				margin: 0 auto;
				padding: 1em 2.5em;
				background: transparent;
				border: 1px solid rgba(255, 255, 255, 0.1);
				border-radius: 30px;
				color: var(--color-text-secondary);
				font-size: 0.85em;
				letter-spacing: 0.15em;
				text-transform: uppercase;
				transition: all 0.3s ease;
			}

			.view-all-link:hover {
				background: rgba(99, 102, 241, 0.1);
				border-color: rgba(99, 102, 241, 0.3);
				color: var(--color-text-primary);
			}

			.view-all-link .link-arrow {
				transition: transform 0.3s ease;
			}

			.view-all-link:hover .link-arrow {
				transform: translateX(5px);
			}

			/* About Section */
			.about-section {
				padding: 10em 4em;
				background: linear-gradient(
					180deg,
					var(--color-bg-primary) 0%,
					#0a0a0a 50%,
					var(--color-bg-primary) 100%
				);
				position: relative;
			}

			.about-content {
				max-width: 1400px;
				margin: 0 auto;
				display: grid;
				grid-template-columns: 1fr 1fr;
				gap: 6em;
				align-items: center;
			}

			.section-label {
				display: flex;
				align-items: center;
				gap: 1em;
				margin-bottom: 2em;
			}

			.label-line {
				width: 30px;
				height: 1px;
				background: rgba(255, 255, 255, 0.2);
			}

			.label-text {
				font-size: 0.7em;
				letter-spacing: 0.3em;
				text-transform: uppercase;
				color: rgba(255, 255, 255, 0.4);
				font-family: 'Space Mono', monospace;
			}

			.about-title {
				font-size: clamp(2.5em, 5vw, 4em);
				font-weight: 200;
				letter-spacing: -0.03em;
				line-height: 1.1;
				margin: 0 0 1.5em 0;
			}

			.highlight {
				color: rgba(255, 255, 255, 0.6);
				font-weight: 300;
			}

			.about-description {
				font-size: 1.1em;
				line-height: 1.8;
				color: rgba(255, 255, 255, 0.6);
				margin-bottom: 2em;
			}

			.about-link {
				display: inline-flex;
				align-items: center;
				gap: 0.75em;
				font-size: 0.85em;
				letter-spacing: 0.15em;
				text-transform: uppercase;
				color: rgba(255, 255, 255, 0.8);
				transition: all 0.3s ease;
			}

			.about-link:hover {
				color: rgba(255, 255, 255, 1);
			}

			.link-arrow {
				transition: transform 0.3s ease;
			}

			.about-link:hover .link-arrow {
				transform: translateX(5px);
			}

			.about-visual {
				position: relative;
			}

			.visual-grid {
				display: grid;
				grid-template-columns: repeat(2, 1fr);
				gap: 1em;
				position: relative;
			}

			.grid-item {
				aspect-ratio: 1;
				background: rgba(255, 255, 255, 0.03);
				border: 1px solid rgba(255, 255, 255, 0.06);
				position: relative;
				overflow: hidden;
			}

			.grid-item::before {
				content: '';
				position: absolute;
				top: 0;
				left: 0;
				right: 0;
				bottom: 0;
				background: linear-gradient(
					135deg,
					rgba(255, 255, 255, var(--glass-opacity-bg-hover)) 0%,
					transparent 50%
				);
				opacity: 0.5;
			}

			/* Contact CTA */
			.contact-cta {
				padding: 10em 4em;
				background: var(--color-bg-primary);
				position: relative;
				display: flex;
				align-items: center;
				justify-content: center;
			}

			.cta-content {
				text-align: center;
				position: relative;
				z-index: 2;
			}

			.cta-title {
				font-size: clamp(2em, 6vw, 4em);
				font-weight: 200;
				letter-spacing: -0.02em;
				color: var(--color-text-primary);
				margin: 0 0 1em 0;
			}

			.cta-description {
				font-size: 1.1em;
				color: var(--color-text-tertiary);
				margin-bottom: 2em;
			}

			.cta-button {
				display: inline-block;
				padding: 1em 3em;
				background: rgba(255, 255, 255, var(--glass-opacity-bg-hover));
				border: 1px solid rgba(255, 255, 255, 0.15);
				color: rgba(255, 255, 255, 0.9);
				font-size: 0.85em;
				letter-spacing: 0.2em;
				text-transform: uppercase;
				transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
				backdrop-filter: blur(10px);
			}

			.cta-button:hover {
				background: var(--border-hover);
				border-color: var(--color-text-muted);
				transform: translateY(-2px);
			}

			.cta-decoration {
				position: absolute;
				top: 50%;
				left: 50%;
				transform: translate(-50%, -50%);
				width: 600px;
				height: 600px;
				pointer-events: none;
			}

			.deco-line {
				position: absolute;
				top: 50%;
				left: 50%;
				width: 1px;
				height: 100%;
				background: rgba(255, 255, 255, 0.03);
			}

			.deco-line::before,
			.deco-line::after {
				content: '';
				position: absolute;
				top: 0;
				left: 0;
				width: 100%;
				height: 1px;
				background: rgba(255, 255, 255, 0.03);
			}

			.deco-line::before {
				top: 0;
				transform: translateY(-50%);
			}

			.deco-line::after {
				bottom: 0;
				transform: translateY(50%);
			}

			/* Footer styles moved to Footer.astro component */


			.footer-content {
				max-width: 1400px;
				margin: 0 auto;
				display: flex;
				justify-content: space-between;
				align-items: center;
			}

			.footer-left {
				display: flex;
				align-items: center;
				gap: 1em;
			}

			.footer-text {
				font-size: 0.85em;
				color: rgba(255, 255, 255, 0.4);
			}

			.footer-divider {
				color: rgba(255, 255, 255, 0.2);
			}

			.footer-right {
				display: flex;
				gap: 2em;
			}

			.footer-link {
				font-size: 0.85em;
				color: var(--color-text-tertiary);
				transition: color 0.3s ease;
			}

			/* Responsive */
			@media (max-width: 1200px) {
				.posts-grid {
					grid-template-columns: repeat(2, 1fr);
				}
			}

			@media (max-width: 1024px) {
				.services-section,
				.featured-posts-section,
				.about-section,
				.contact-cta,
				.arch-footer {
					padding-left: 2em;
					padding-right: 2em;
				}

				.about-content {
					grid-template-columns: 1fr;
					gap: 4em;
				}

				.posts-grid {
					grid-template-columns: 1fr;
				}
			}

			@media (max-width: 768px) {
				.services-grid {
					grid-template-columns: 1fr;
				}

				.footer-content {
					flex-direction: column;
					gap: 1.5em;
					text-align: center;
				}

				.footer-left {
					flex-direction: column;
					gap: 0.5em;
				}

				.footer-right {
					gap: 1.5em;
				}
			}
		</style>
	</body>
</html>
